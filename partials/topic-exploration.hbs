{{!--
    TODO: refactor to accomplish the following:
    - latest post is on the left and has a great big box for the image
    - other posts are on the right in a list format
    - each post has:
        - title
        - excerpt
        - feature image (if available)
        - date published
        - estimated reading time
--}}
<section class="gh-topic gh-topic-grid">
    {{!-- Display the tag name and link to the tag page --}}
    <header class="gh-topic-header">
        <h2 class="gh-topic-name">
            <a href="{{url}}">{{name}}</a>
        </h2>
        <a class="gh-topic-link" href="{{url}}">More {{> "icons/arrow-right"}}</a>
    </header>

    <div class="topic-content">
        {{!-- Get the 4 latest posts from this tag --}}
        {{#get "posts" include="tags,authors" filter="tag:{{slug}}" limit="4"}}
            <div class="topic-latest">
                {{#foreach posts limit='1'}}
                    {{!-- Latest post container --}}
                    <article class="gh-card large">
                        <a class="gh-card-link-large" href="{{url}}">
                            {{#if feature_image}}
                                <figure class="gh-card-image">
                                    <img
                                        srcset="{{img_url feature_image size="s"}} 300w,
                                                {{img_url feature_image size="m"}} 720w,
                                                {{img_url feature_image size="l"}} 960w,
                                                {{img_url feature_image size="xl"}} 1200w,
                                                {{img_url feature_image size="xxl"}} 2000w"
                                        sizes="(max-width: 1200px) 100vw, 1200px"
                                        src="{{img_url feature_image size="m"}}"
                                        alt="{{#if feature_image_alt}}{{feature_image_alt}}{{else}}{{title}}{{/if}}"
                                    >
                                </figure>
                            {{/if}}

                            <div class="gh-card-wrapper">
                                <header class="gh-card-header">
                                    <h3 class="gh-card-title">{{title}}</h3>
                                </header>

                                {{#if excerpt}}
                                    <div class="gh-card-excerpt">{{excerpt}}</div>
                                {{/if}}

                                <footer class="gh-card-footer">
                                    <time class="gh-card-date" datetime="{{date format="YYYY-MM-DD"}}">{{date format="DD MMM YYYY"}}</time>
                                    {{#if reading_time}}
                                        <span class="gh-card-length">{{reading_time}}</span>
                                    {{/if}}
                                </footer>
                            </div>
                        </a>
                    </article>
                {{/foreach}}
            </div>
            
            <div class="topic-other">
                {{#foreach posts from='2'}}
                    {{!-- Other posts --}}
                    <article class="gh-card">
                        <a class="gh-card-link" href="{{url}}">
                            {{#if feature_image}}
                                <figure class="gh-card-image">
                                    <img
                                        srcset="{{img_url feature_image size="s"}} 300w,
                                                {{img_url feature_image size="m"}} 720w,
                                                {{img_url feature_image size="l"}} 960w,
                                                {{img_url feature_image size="xl"}} 1200w,
                                                {{img_url feature_image size="xxl"}} 2000w"
                                        sizes="(max-width: 1200px) 100vw, 1200px"
                                        src="{{img_url feature_image size="m"}}"
                                        alt="{{#if feature_image_alt}}{{feature_image_alt}}{{else}}{{title}}{{/if}}"
                                    >
                                </figure>
                            {{/if}}

                            <div class="gh-card-wrapper">
                                <header class="gh-card-header">
                                    <h3 class="gh-card-title">{{title}}</h3>
                                </header>

                                {{#if excerpt}}
                                    <div class="gh-card-excerpt">{{excerpt}}</div>
                                {{/if}}

                                <footer class="gh-card-footer">
                                    <time class="gh-card-date" datetime="{{date format="YYYY-MM-DD"}}">{{date format="DD MMM YYYY"}}</time>
                                    {{#if reading_time}}
                                        <span class="gh-card-length">{{reading_time}}</span>
                                    {{/if}}
                                </footer>
                            </div>
                        </a>
                    </article>
                {{/foreach}}
            </div>
        {{/get}}
    </div>
</section>